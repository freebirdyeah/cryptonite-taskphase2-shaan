# picoCTF: Binary Exploitation

_for picoCTF challenges involving Binary Exploitation_

## format string 0

On typing out `~$ cat format-string-0.c` this section of the program looked particularly interesting:-


```
void sigsegv_handler(int sig) {
    printf("\n%s\n", flag);
    fflush(stdout);
    exit(1);
}
```

I knew `sigsev` referred to segmentation faults (Which I found out when I was trying to debug a program which I wrote for Advent of Code a while back), so I assumed causing the program to undergo a segfault will print the flag.

I ran `~$ gdb format-string-0` after giving permissions, I set `break main` then `run` and then repeatedly ran `ni` to go through the program. 

I played the game normally, and in the second part:-


```
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
```

I got:-

```
Program received signal SIGSEGV, Segmentation fault.
__strlen_avx2 () at ../sysdeps/x86_64/multiarch/strlen-avx2.S:74
74      ../sysdeps/x86_64/multiarch/strlen-avx2.S: No such file or directory.
```

Got confused for a second there but I replayed the game after running the instance and got the flag.

flag: `picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}`

### incorrect tangents

not really a tangent but after:-

```
Program received signal SIGSEGV, Segmentation fault.
__strlen_avx2 () at ../sysdeps/x86_64/multiarch/strlen-avx2.S:74
74      ../sysdeps/x86_64/multiarch/strlen-avx2.S: No such file or directory.
```

I realised I just had to do this on the challenge instance.
